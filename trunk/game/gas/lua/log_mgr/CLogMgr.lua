
--------------------------------[[写log用到的类型枚举表]]---------------------------
event_type_tbl = 
{
	["npc商店购买"]						= 1,
	["npc商店出售"]						= 2,
	["邮寄"]							= 3,
	["创建佣兵小队"]					= 4,
	["锻造铸甲"]						= 5,
	["捐献"]							= 6,
	["领取"]							= 7,
	["烹饪制药"]						= 8,
	["物品使用"]						= 9,
	["左键点击删除"]					= 10,
	["寄售"]							= 11,
	["任务品或者道具物品删除"]			= 12,
	["GM删除物品"]						= 13,
	["盒子物品删除"]					= 14,
	["装备炼化"]						= 15,
	["添加出售订单"]					= 16,
	["寄售交易所出售"]					= 17,
	["寄售交易所购买"]					= 18,
	["手动删除出售订单"]				= 19,
	["系统删除出售订单"]				= 20,
	["自由拾取物品"]					= 22,
	["角色初始化产生装备"]				= 23,
	["阵法还原成阵法书"]				= 24,
	["GM添加物品"]						= 25,
	["盒子物品掉落"]					= 26,
	["合成"]							= 27,
	["白宝石鉴定"]						= 28,
	["宝石摘除"]						= 29,
	["装备炼化魂珠"]					= 30,
	["新邮件"]							= 31,
	["副本奖励"]						= 32,
	["掉落拍卖"]						= 33,
	["淬炼"]							= 34,
	["锻造"]							= 35,
	["生产"]							= 36,
	["离线种花产出"]					= 37,
	["炮塔钥匙产出"]					= 38,
	["道具产出"]						= 39,
	["复活石使用"]						= 40,
	["帮会建筑物品产出"]				= 41,
	["任务奖励"]						= 42,
	["任务品或者道具给予"]				= 43,
	["点npc给物品"]						= 45,
	["领取机械兽"]						= 46,
	["在线种花产出"]					= 47,
	["拍卖获得物品"]					= 48,
	["采集单个格子的物品"]				= 49,
	["采集所有格子的物品"]				= 50,
	["平均分配拾取物品"]				= 51,
	["需求分配"]						= 52,
	["任务掉落物品"]					= 53,
	["点npc尸体掉落(点一个格子)"]		= 54,
	["装备洗白"]						= 55,
	["踩trap给物品"]					= 56,
	["点npc尸体掉落(点所有格子)"]		= 57,
	["杀人获得经验"]					= 58,
	["杀怪获得经验"]					= 59,
	["使用经验球获得经验"]				= 60,
	["GM指令加经验"]					= 61,
	["使用魂珠加魂值"]					= 62,
	["小游戏"]							= 63,
	["爆魂"]							= 64,
	["死亡掉魂"]						= 65,
	["杀人加魂"]						= 66,
	["装备强化灌输魂"]					= 67,
	["技能物品添加"]					= 68,
	["角色初始化携带技能物品"]			= 69,
	["玩家踩Trap给经验"]				= 70,
	["分解产出"]						= 71,
	["装备进阶魂"] 						= 72,
	["GM指令加积分"]					= 73,
	["角斗场副本加积分"]				= 74,
	["竞技场副本加积分"]				= 75,
	["PK状态下杀怪加积分"]				= 76,
	["玩家踩trap加钱"]					= 78,
	["大夺宝加钱"]						= 79,
	["帮会出售粮草"]					= 80,
	["玩家邮件提取钱"]					= 81,
	["往仓库存钱"]						= 82,
	["从仓库取钱"]						= 83,
	["GM指令加钱"]						= 84,
	["玩家交易"]						= 85,
	["喝酒扣钱"]						= 86,
	["购买交易所订单"]					= 87,
	["修装备扣钱"]						= 88,
	["学技能扣钱"]						= 89,
	["佣兵币兑换流通钱"]				= 91,
	["帮会解散删除物品"]				= 94,
	["帮会删除成员"]					= 95,
	["生活技能学习或升级"]				= 96,
	["Gm指令学习生活技能"]				= 97,
	["Gm指令加生活技能熟练度"]			= 98,
	["生活技能专精学习"]				= 99,
	["技能学习消耗魂"]					= 100,
	["商城购买"]						= 101,
	["商城赠送"]						= 102,
	["指引奖励"]						= 103,
	["玩家杀怪获得魂值"]				= 104,
	["gm发的邮件"]						= 105,
	["系统退回邮件"]					= 106,
	["寄售交易所邮件"]					= 107,
	["活动奖励邮件"] 					= 108,
	["种花系统邮件"] 					= 109,
	["积分赛奖励邮件"]					= 110,
	["背包满石头融合或鉴定邮件"]		= 111,
	["订单过期邮件"]					= 112,
	["购买订单成功邮件"]				= 113,
	["订单被成功购买邮件"]				= 114,
	["佣兵小队建筑制造"]				= 115,
	["佣兵小队取消物品制造"]			= 116,
	["佣兵小队物品制造"] 				= 117,
	["佣兵小队粮草收购"] 				= 118,
	["佣兵小队粮草出售"] 				= 119,
	["佣兵小队成员捐献金钱"]			= 120,
	["佣兵小队科技研发"]				= 121,
	["佣兵小队宣战"]					= 122,
	["佣兵小队宣战竞标失败"]			= 123,
	["佣兵小队GM指令加钱"]				= 124,
	["佣兵小队积分赛奖励"]				= 125,
	["佣兵小队抢夺资源点活动"]			= 126,
	["佣兵卡牌奖励"]					= 127,
	["佣兵小队杀人加功勋"]				= 128,
	["佣兵小队挑战时间到加荣誉"]		= 129,
	["佣兵小队挑战分出胜负加荣誉"] 		= 130,
	["佣兵小队建筑被打爆加荣誉"]		= 131,
	["佣兵小队npc驻地建筑被打爆加荣誉"]	= 132,
	["佣兵小队建筑打爆资源掉落"] 		= 133,
	["佣兵小队建筑修理"] 				= 134,
	["佣兵小队更新建筑等级"] 			= 135,
	["分解删除"]						= 136,
	["Boss争夺战奖励"]					= 137,
	["Pk状态杀死玩家加积分"] 			= 138,
	["道具商城余额领取"]				= 139,
	["大逃杀加积分"] 					= 140,
	["团商店购买物品"] 					= 141,
	["任务加佣兵券"] 					= 142,
	["杀npc增加团贡"] 					= 143,
	["任务帮会荣誉奖励"] 				= 144,
	["任务帮会团贡奖励"] 				= 145,
	["修行塔给绑定金币"] 				= 146,
	["拍卖竞价扣钱"] 					= 147,
	["拍卖竞价补钱"] 					= 148,
	["拍卖竞价返钱"] 					= 149,
	["拍卖OBJ消失返钱"] 				= 150,
	["拍卖系统返钱"] 					= 151,
	["拍卖平均分钱"] 					= 152,
	["npc商店购回"]						= 153,
	["表情动作"]						= 154,
	["挂机采矿产出"]					= 155,
	["创建佣兵团"]						= 156,
	["国贡商店购买物品"] 				= 158,
	["gm补偿"]    						= 159,
	["世界频道聊天扣钱"] 				= 160,
	["提升装备可强化上限"] 				= 161,
	["种花"] 							= 162,
	["掉落物品拍卖过程"] 				= 163,
	["代工厂制造"] 						= 164,
	["代工成功"]   						= 165,
	["Pk状态被杀死减积分"] 				= 166,
	["离线经验兑换"]   					= 167,
	["资源点队长奖励"]  				= 168,
	["佣兵小队GM指令加等级"]			= 169,
	["佣兵小队GM指令加荣誉"]			= 170,
	["佣兵小队GM指令加资源"]			= 171,
	["队友任务经验分享"]				= 172,
	["特殊NPC传送"]   					= 173,
	["抢夺资源点加国贡"]   				= 174,
	["魂瓶满产生魂珠"]   				= 175,
	["帮会挑战领取挑战建筑"]   			= 176,
	["代工收费"]   						= 177,
	["玩家转职"]						= 179,
	["佣兵小队拆除粮草仓扣除所有军资"]  = 180,
	["交易所添加订单管理费"] 			= 181,
	["添加代工订单管理费"] 				= 182,
	["技能学习管理费"] 					= 183,
	["邮件管理费"] 						= 184,
	["取消代工订单回退金钱"]   			= 185,
	["装备镶嵌护甲片扣钱"] 				= 186,
	["传声频道发消息扣钱"]				= 187,
	["玩家交易扣税"]					= 188,
	["代工成功扣税"]					= 189,
	["寄售交易所扣税"]					= 190,
	["邮寄扣税"]						= 191,
	["拍卖分钱扣税"]					= 192,
	["代工订单制作"]					= 193,
	["添加代工订单"]					= 194,
	["手动取消代工所订单"]              = 195,
	["自动取消代工所订单"]              = 196,
	["掉落物品拍卖结果"]                = 197,
	["特殊NPC传送非绑定金币"]   		= 198,
	["过期邮件删除"]   					= 199,
	["装备追加消耗"]                    = 200,
	["佣兵小队征粮扣钱"]                = 201,
	["佣兵小队类型提升扣钱"]            = 202,
	["gm工具给佣兵小队仓库加物品"]      = 203,
	["gm恢复装备"]        				= 204,
	["佣兵小队补偿资金"]        		= 205,
	["佣兵小队补偿军资"]        		= 206,
	["WebShop购买物品"]        			= 207,
	["添加求购订单"]        			= 208,
	["手动删除收购订单"]				= 209,
	["出售收购订单"]					= 210,
	["收购订单成功邮件"]				= 211,
	["收购订单超时删除"]				= 212,
	["收购订单超时邮件"]				= 213,
	["收购订单完成删除"]				= 214,
	["收购订单管理费"]					= 215,
	["佣兵小队发展度满足升级"]			= 216,
	["任务加发展度奖励"]				= 217,
	["怪物攻城奖励"]					= 218,
	["重金招募奖励"]					= 219,
	["篝火活动"]						= 220,
	["GM加发展度奖励"]					= 221,
	["服务器星级奖励"]					= 222,
	["佣兵小队转类型扣钱"]				= 223,
	["抢夺资源点获胜"]					= 224,
	["玩家捐钱换经验"]					= 225,
	["玩家捐钱换魂值"]					= 226,
	["玩家捐钱换军资"]					= 227,
	["购买点券"]						= 228,
	["学习佣兵小队科技"]				= 229,
	["使用VIP道具获得物品"]				= 230,
	["VIP邮件物品"]						= 231,
	["VIP邮件"]							= 232,
	["佣兵小队补偿荣誉"]				= 233,
	["最强佣兵小队奖励"]				= 234,
	["领取军资"]						= 235,
	["生活技能遗忘"]					= 236,
	["龙穴活动奖励"]					= 237,
	["国战奖励国贡"]					= 238,
	["每周给队长发送奖励"]    			= 239,
	["相同激活码账号经验和魂分配"]		= 240,
	["角色升级"]						= 241,
	["D级佣兵福利"]						= 242,
	["E级佣兵福利"]						= 243,
	["F级佣兵福利"]						= 244,
	["G级佣兵福利"]						= 245,
}

--@brief 获得写log需要的四个属性值
function GetPropertyValue(player)
	local uNatureResistance = player:GetNatureResistance()
	local uEvilResistance =  player:GetEvilResistance()
	local uDestructionResistance = player:GetDestructionResistance()
	local uDefence = player:GetDefence()
	
	return {uNatureResistance,uEvilResistance,uDestructionResistance,uDefence}
end

local function WriteLog(...)
	local arg = {...}
	
	WriteMegaLog(table.concat(arg, "\t"))
end
-------------------------------------------------------------
--@brief 记录角色速度变化log
--@param sCharName：角色名称
--@param fSpeed：变化后的速度
--@param szSpeedChangeReason:变化原因
function SavePlayerSpeedLog(sCharName, fSpeed, szSpeedChangeReason)
	WriteLog("tbl_log_char_speed",sCharName,fSpeed,os.date("%y-%m-%d %H:%M:%S"),szSpeedChangeReason)
end
--------------------------------------------------------------
--@brief 记录外挂信息
--@param userName：账号名称
--@param charId：角色id
--@param sceneName：场景名称
function OnCheat(userName,charId,sceneName)
	
	WriteLog("tbl_log_user_cheat",userName, charId, os.date("%y-%m-%d %H:%M:%S"), sceneName)
end
------------------------------------------------------
--@brief 记录佣兵小队挑战结果Log信息
--@param uChallengeTongId:挑战佣兵小队id
--@param uRecoveryTongId:防御佣兵小队id
--@param uWarzoneId:战区id
--@param uIndex:驻地id
--@param uResult:结果 0 - 失败 1 - 成功
function TongChallengeEndLog(uChallengeTongId,uRecoveryTongId,uWarzoneId,uIndex,uResult)

	WriteLog("tbl_log_tong_challenge_end",uChallengeTongId,uRecoveryTongId,uWarzoneId,uIndex,uResult,os.date("%y-%m-%d %H:%M:%S"))
end
------------------------------------------------------
--@brief 记录角色经验、魂系数变化log
--@param charId：角色id
--@param uModulusType：系数类型 1-经验 2-魂 3-副本经验
--@param uModulusValue：改变之后的经验系数
function SaveExpSoulModulusChangeLog(charId,uModulusType,uModulusValue)
	
	WriteLog("tbl_log_char_exp_soul_modulus",charId,uModulusType,uModulusValue, os.date("%y-%m-%d %H:%M:%S"))
end
